# Продуктовое видение (PRD)
## Orion Soft Internal AI Assistant — **Visior**

---

# 1. Обзор
Visior — корпоративный AI-ассистент, который ускоряет поиск знаний, уменьшает нагрузку на поддержку и повышает качество самообслуживания. Он объединяет:
- полнотекстовый поиск по внутренней документации;
- генерацию ответов с опорой на RAG-пайплайн;
- многослойную retrieval-систему (doc → section → chunk);
- строгий контроль доступа и безопасность уровня OWASP LLM Top-10;
- автоматическую индексацию документов и удобные API для интеграций.

Основная ценность — быстрые, точные и проверяемые ответы сотрудникам, клиентам и партнёрам.

---

# 2. Цели
## 2.1 Основные
1. Предоставлять релевантные, обоснованные ответы по продуктам Orion Soft.
2. Обеспечить доступ к документации через RAG с высокой точностью и полнотой.
3. Снизить количество эскалаций в техподдержку за счёт автоматизации ответов.
4. Сократить время поиска информации в больших документах.
5. Исключить утечки и небезопасные ответы, соблюсти комплаенс.
6. Обеспечить прозрачную интеграцию в корпоративную инфраструктуру (SSO, порталы, чат-боты).

## 2.2 Дополнительные
- Ускорить онбординг сотрудников.
- Показать метрики использования и эффективности.
- Снизить стоимость поддержки на пользователя.
- Стандартизировать доступ к знаниям между командами.

## 2.3 Ограничения (Non-Goals)
Visior **не** предназначен для генерации кода, запуска скриптов, предиктивной аналитики или замены сложных консультаций инженеров.

---

# 3. Стейкхолдеры
## Первичные
1. **Инженеры поддержки (L1/L2/L3)** — используют ассистента каждый день, критичный сегмент.
2. **Сотрудники отдела разработки / QA / продукт / продажи** — ищут спецификации и инструкции.
3. **Клиенты и партнёры** (если есть внешняя версия) — self-service для типовых вопросов.

## Вторичные
4. **Product Managers** — определяют roadmap и KPI.
5. **AI/ML Team** — отвечают за модели, retrievers, embeddings.
6. **Security & Compliance** — следят за политиками и соответствием OWASP.
7. **IT Operations / SRE** — эксплуатация, мониторинг, SLA.
8. **Документационная команда** — готовит контент для ingestion.
9. **Юридический отдел** — контролирует лицензии, обработку персональных данных.

---

# 4. User Stories / Use Cases
1. *Саппорт-инженер* задаёт вопрос «Как починить LDAP синхронизацию?» и получает пошаговый ответ с ссылками на документы.
2. *Продакт-менеджер* проверяет статус загрузки новой спецификации и видит, что документ проиндексирован.
3. *Новый сотрудник* просит «Дай обзор архитектуры модуля Orion Security» и получает краткое summary.
4. *Клиент* загружает документ белой книги — через некоторое время ассистент уже использует его в ответах.
5. *Security officer* скачивает отчёт по safety-блокировкам и аудитам trace_id.

---

# 5. Требования к функциональности
## 5.1 Core Experience
- Chat UI с отображением источников, trace_id и статуса safety.
- Поддержка RU/EN (минимум RU на старте, EN в roadmap).
- Возможность продолжить диалог в рамках conversation_id.

## 5.2 Документы и ingestion
- Загрузка PDF/DOCX, трекинг статусов `uploaded/processing/indexed/failed`.
- Публикация событий `document_ingested` / `ingestion_failed`.
- Метаданные: продукт, версия, теги, арендатор.

## 5.3 Retrieval & LLM
- Гибкий поиск: doc-level, section-level, chunk-level, reranking.
- Лимит на количество чанков и токенов (управляется Orchestrator).
- MCP-инструменты: чтение страниц, локальный поиск, обращение к объектному хранилищу.

## 5.4 Безопасность
- Input/Output safety, PII-sanitize, DLP.
- Tenant isolation на уровне всех сервисов.
- Аудит запросов, логирование trace_id, хранение действий MCP.

## 5.5 Интеграции
- REST API (`/api/v1/...`).
- Webhook/queues для статусов ingestion.
- Возможность встраивания в корпоративные мессенджеры.

---

# 6. KPI / Метрики
- CSAT ответов ассистента.
- % обращений, закрытых без эскалации.
- Среднее время ответа (p95 latency) по компонентам.
- Количество ingestion в сутки, % успешно проиндексированных документов.
- Количество safety-блокировок и трансформаций.

---

# 7. Ограничения и риски
- Качество исходной документации влияет на ответ.
- Необходимо регулярное обновление моделей и embeddings.
- Требуются строгие процессы обновления политик безопасности.
- Масштабирование ingestion: необходимо планировать Compute/Storage.

---

# 8. Roadmap (высокоуровневый)
1. **MVP**: API Gateway, Safety, Orchestrator, Retrieval, LLM mock, базовый ingestion.
2. **Iteration 2**: полноценный MCP proxy, observability, продвинутая Document Service.
3. **Iteration 3**: внешние интеграции, расширенные safety-политики, поддержка EN.

---

# 9. Acceptance Criteria
- Все публичные API документированы (см. `docs/api_docs.md`).
- Сервисы запускаются через `docker compose up --build`.
- `pytest` и `pre-commit` зелёные.
- Safety блокирует вредоносные запросы минимум в 99% кейсов QA.
- Инженер поддержки получает корректный ответ на типовые вопросы (smoke-набор).

---

# 10. Следующие шаги
1. Уточнить требования к интеграции с порталом и чат-ботами.
2. Согласовать политикам срок хранения логов safety и trace_id.
3. Спланировать расширенный ingestion (OCR, таблицы, изображения).
4. Настроить процесс обновления RAG-индексов и ретрейна embeddings.
